import{P as u,m as p}from"./index-DfhsAgI1.js";const l=["stair","non-stair","server","test"],m=async e=>{if(e)return new Promise((n,t)=>{const a=new FileReader;a.onload=()=>{const s=a.result;n(s.replace(/^data:image\/[a-z]+;base64,/,""))},a.onerror=t,a.readAsDataURL(e)})},o=()=>{h().update()},i={announements:{async getAll(){return fetch("/api/announcements").then(e=>e.json())},async create(e){const t=await(await fetch("/api/announcements",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return o(),t},async get(e){return fetch(`/api/announcements/${e}`).then(n=>n.json())},async update(e){const t=await(await fetch(`/api/announcements/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return o(),t},async delete(e){await fetch(`/api/announcements/${e}`,{method:"DELETE"}).then(o)},async getTypes(){return fetch("/api/announcements/types").then(e=>e.json())},async publish(e,n,t,a,s,d){const r=await fetch(`/api/announcements/${e}/publish`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,scope:n,server:t,type:a,persona:s,image:await m(d)})});if(r.ok)return null;const c=await r.text();return console.error(c),c},async discordServers(){return fetch("/api/announcements/discord/servers").then(e=>e.json())},async telegramChats(){return fetch("/api/announcements/telegram/chats").then(e=>e.json())},async personas(){return fetch("/api/announcements/personas").then(e=>e.json())}},db:{async students(){return fetch("/api/students").then(e=>e.json())},async updateStudents(e){await fetch("/api/students",{method:"POST",headers:{"Content-Type":"application/xml"},body:e})},async updateModules(e){await fetch("/api/modules",{method:"POST",headers:{"Content-Type":"application/xml"},body:e})},async getDegreeProgrammes(){return fetch("/api/degree-programmes").then(e=>e.json())},async updateDegreeProgrammes(e){await fetch("/api/degree-programmes",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})}}},h=u("counter",()=>{const e=p([]),n=async()=>{e.value=await i.announements.getAll()},t=async()=>"/announcements/"+(await i.announements.create({title:"",message:{de:"",en:""}})).id;return n(),{announcements:e,update:n,create:t}});export{l as A,i as a,h as u};
