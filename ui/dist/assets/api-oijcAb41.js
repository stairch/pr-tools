import{J as c,g as i}from"./index-BCjy1ozn.js";const d=c("counter",()=>{const e=i([]),n=async()=>{e.value=await u.announements.getAll()};return n(),{announcements:e,update:n}}),m=["stair","non-stair","server","test"],p=async e=>{if(e)return new Promise((n,t)=>{const a=new FileReader;a.onload=()=>{const s=a.result;n(s.replace(/^data:image\/[a-z]+;base64,/,""))},a.onerror=t,a.readAsDataURL(e)})},o=()=>{d().update()},u={announements:{async getAll(){return fetch("/api/announcements").then(e=>e.json())},async create(e){const t=await(await fetch("/api/announcements",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return o(),t},async get(e){return fetch(`/api/announcements/${e}`).then(n=>n.json())},async update(e){const t=await(await fetch(`/api/announcements/${e.id}`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json();return o(),t},async delete(e){await fetch(`/api/announcements/${e}`,{method:"DELETE"}).then(o)},async getTypes(){return fetch("/api/announcements/types").then(e=>e.json())},async publish(e,n,t,a,s,r){fetch(`/api/announcements/${e}/publish`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({id:e,scope:n,server:t,type:a,persona:s,image:await p(r)})})},async discordServers(){return fetch("/api/announcements/discord/servers").then(e=>e.json())},async personas(){return fetch("/api/announcements/personas").then(e=>e.json())}},db:{async students(){return fetch("/api/students").then(e=>e.json())},async updateStudents(e){await fetch("/api/students",{method:"POST",headers:{"Content-Type":"application/xml"},body:e})},async updateModules(e){await fetch("/api/modules",{method:"POST",headers:{"Content-Type":"application/xml"},body:e})},async updateDegreeProgrammes(e){await fetch("/api/degree-programmes",{method:"POST",headers:{"Content-Type":"application/xml"},body:e})}}};export{m as A,u as a,d as u};
